<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è§†é¢‘å¤„ç†å·¥ä½œå° - MVPç‰ˆæœ¬</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            min-height: 100vh;
        }
        .drop-zone {
            border: 2px dashed #64748b;
            transition: all 0.3s ease;
            min-height: 300px;
        }
        .drop-zone.dragover {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }
        .progress-bar {
            background: linear-gradient(90deg, #3b82f6, #10b981);
            height: 8px;
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        .mvp-badge {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 700;
        }
        .capability-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .capability-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        .capability-card.active {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }
        .capability-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
        }
    </style>
</head>
<body>
    <!-- ç»Ÿä¸€å¯¼èˆªæ å®¹å™¨ -->
    <div id="navbar-container"></div>
    
    <!-- å·¥ä½œå°æ ‡é¢˜æ  -->
    <div class="bg-slate-800/50 border-b border-slate-700">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <h1 class="text-2xl font-bold text-white">
                    <i class="fas fa-magic mr-2 text-blue-400"></i>è§†é¢‘å¤„ç†å·¥ä½œå°
                </h1>
                <div class="text-green-400 font-semibold text-sm">
                    <i class="fas fa-gift mr-1"></i>å…è´¹è¯•ç”¨: 1åˆ†é’Ÿ
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-4 py-6">
        <!-- MVPè¯´æ˜æ¨ªå¹… -->
        <div class="bg-gradient-to-r from-blue-600/20 to-purple-600/20 border border-blue-500/30 rounded-xl p-6 mb-8">
            <div class="text-center">
                <h2 class="text-xl font-bold text-white mb-2">ğŸ¬ è§†é¢‘åŸå­èƒ½åŠ›å¤„ç†ä¸­å¿ƒ</h2>
                <p class="text-gray-300 text-sm">é€‰æ‹©æ‰€éœ€çš„è§†é¢‘å¤„ç†èƒ½åŠ›ï¼Œç®€å•ä¸Šä¼ ï¼ŒAIè‡ªåŠ¨å¤„ç†ï¼Œå¿«é€Ÿè·å¾—ç»“æœ</p>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            
            <!-- å·¦ä¾§ï¼šè§†é¢‘åŸå­èƒ½åŠ›é€‰æ‹© -->
            <div class="lg:col-span-1">
                <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
                    <h2 class="text-xl font-bold text-white mb-6">
                        <span class="text-blue-400">æ­¥éª¤ 1:</span> é€‰æ‹©å¤„ç†èƒ½åŠ›
                    </h2>
                    
                    <!-- åŸºç¡€å¤„ç†èƒ½åŠ› -->
                    <div class="mb-6">
                        <h3 class="text-sm font-semibold text-gray-400 mb-3 uppercase tracking-wide">æ™ºèƒ½å»é™¤</h3>
                        <div class="space-y-2">
                            <div class="capability-card bg-blue-600/20 border border-blue-500/50 rounded-lg p-3 active" data-capability="removeSubtitle">
                                <div class="flex items-center">
                                    <div class="capability-icon bg-gradient-to-r from-blue-500 to-blue-600">
                                        <i class="fas fa-text-slash text-white text-sm"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-white text-sm">å»é™¤å­—å¹•</h4>
                                        <p class="text-xs text-gray-300">AIæ™ºèƒ½è¯†åˆ«å»é™¤</p>
                                    </div>
                                </div>
                            </div>

                            <div class="capability-card bg-slate-700 hover:bg-slate-600 rounded-lg p-3" data-capability="removeWatermark">
                                <div class="flex items-center">
                                    <div class="capability-icon bg-gradient-to-r from-green-500 to-green-600">
                                        <i class="fas fa-droplet-slash text-white text-sm"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-white text-sm">å»é™¤æ°´å°</h4>
                                        <p class="text-xs text-gray-300">æ™ºèƒ½æ£€æµ‹å»é™¤</p>
                                    </div>
                                </div>
                            </div>

                            <div class="capability-card bg-slate-700 hover:bg-slate-600 rounded-lg p-3" data-capability="removeLogo">
                                <div class="flex items-center">
                                    <div class="capability-icon bg-gradient-to-r from-purple-500 to-purple-600">
                                        <i class="fas fa-ban text-white text-sm"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-white text-sm">å»é™¤Logo</h4>
                                        <p class="text-xs text-gray-300">ç²¾å‡†è¯†åˆ«å»é™¤</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- å†…å®¹å¤„ç† -->
                    <div class="mb-6">
                        <h3 class="text-sm font-semibold text-gray-400 mb-3 uppercase tracking-wide">å†…å®¹å¤„ç†</h3>
                        <div class="space-y-2">
                            <div class="capability-card bg-slate-700 hover:bg-slate-600 rounded-lg p-3" data-capability="textExtract">
                                <div class="flex items-center">
                                    <div class="capability-icon bg-gradient-to-r from-indigo-500 to-indigo-600">
                                        <i class="fas fa-file-text text-white text-sm"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-white text-sm">è§†é¢‘æ–‡æ¡ˆæå–</h4>
                                        <p class="text-xs text-gray-300">è¯­éŸ³è½¬æ–‡å­—æå–</p>
                                    </div>
                                </div>
                            </div>

                            <div class="capability-card bg-slate-700 hover:bg-slate-600 rounded-lg p-3" data-capability="translate">
                                <div class="flex items-center">
                                    <div class="capability-icon bg-gradient-to-r from-orange-500 to-orange-600">
                                        <i class="fas fa-language text-white text-sm"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-white text-sm">è§†é¢‘ç¿»è¯‘</h4>
                                        <p class="text-xs text-gray-300">å¤šè¯­è¨€ç¿»è¯‘å­—å¹•</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- AIå£°éŸ³å¤„ç† -->
                    <div class="mb-6">
                        <h3 class="text-sm font-semibold text-gray-400 mb-3 uppercase tracking-wide">AIåˆ›ä½œ</h3>
                        <div class="space-y-2">
                            <div class="capability-card bg-slate-700 hover:bg-slate-600 rounded-lg p-3" data-capability="voiceClone">
                                <div class="flex items-center">
                                    <div class="capability-icon bg-gradient-to-r from-pink-500 to-pink-600">
                                        <i class="fas fa-microphone-alt text-white text-sm"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-white text-sm">å£°éŸ³å…‹éš†</h4>
                                        <p class="text-xs text-gray-300">å…‹éš†ä¸ªæ€§åŒ–å£°éŸ³</p>
                                    </div>
                                </div>
                            </div>

                            <div class="capability-card bg-slate-700 hover:bg-slate-600 rounded-lg p-3" data-capability="digitalHuman">
                                <div class="flex items-center">
                                    <div class="capability-icon bg-gradient-to-r from-cyan-500 to-blue-600">
                                        <i class="fas fa-user-astronaut text-white text-sm"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-white text-sm">æ•°æ™ºäººç”Ÿæˆ</h4>
                                        <p class="text-xs text-gray-300">å¿«é€Ÿåˆ›å»ºæ•°å­—äººè§†é¢‘</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- å½“å‰é€‰æ‹©æ˜¾ç¤º -->
                    <div class="bg-blue-600/20 border border-blue-500/30 rounded-lg p-4">
                        <h4 class="font-semibold text-white mb-2">
                            <i class="fas fa-check-circle text-blue-400 mr-2"></i>å½“å‰é€‰æ‹©
                        </h4>
                        <div class="text-sm text-gray-300" id="selectedCapability">
                            å»é™¤å­—å¹• - AIæ™ºèƒ½è¯†åˆ«è§†é¢‘ä¸­çš„å­—å¹•æ–‡å­—
                        </div>
                        <div class="text-xs text-blue-400 mt-2" id="selectedPrice">
                            èµ·ä»·: Â¥2/åˆ†é’Ÿ
                        </div>
                    </div>
                </div>
            </div>

            <!-- ä¸­é—´ï¼šè§†é¢‘ä¸Šä¼ å’Œé¢„è§ˆåŒºåŸŸ -->
            <div class="lg:col-span-2">
                <div class="bg-slate-800 rounded-xl p-6 border border-slate-700 mb-6">
                    <h2 class="text-xl font-bold text-white mb-4">
                        <span class="text-purple-400">æ­¥éª¤ 2:</span> ä¸Šä¼ è§†é¢‘
                    </h2>
                    
                    <!-- ç®€åŒ–çš„ä¸Šä¼ åŒºåŸŸ -->
                    <div class="drop-zone bg-slate-700/50 rounded-xl p-8 text-center border-slate-600" 
                         ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                        <div class="mb-6">
                            <i class="fas fa-cloud-upload-alt text-6xl text-blue-400 mb-4"></i>
                            <h3 class="text-xl font-semibold text-white mb-2">æ‹–æ‹½è§†é¢‘æ–‡ä»¶åˆ°è¿™é‡Œ</h3>
                            <p class="text-gray-400 mb-4">æˆ–è€…ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</p>
                            <input type="file" id="fileInput" accept="video/*,audio/*" style="display: none;" onchange="handleFileSelect(event)">
                            <button onclick="document.getElementById('fileInput').click()" 
                                    class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold">
                                <i class="fas fa-folder-open mr-2"></i>é€‰æ‹©è§†é¢‘æ–‡ä»¶
                            </button>
                        </div>
                        <div class="text-sm text-gray-500" id="fileFormatHint">
                            æ”¯æŒæ ¼å¼ï¼šMP4, AVI, MOV, MKV | æœ€å¤§æ–‡ä»¶ï¼š500MB
                        </div>
                    </div>
                </div>

                <!-- å¤„ç†åˆ—è¡¨ -->
                <div class="bg-slate-800 rounded-xl border border-slate-700" id="processingList" style="display: none;">
                    <div class="p-6 border-b border-slate-700">
                        <h3 class="text-lg font-semibold text-white">
                            <span class="text-green-400">æ­¥éª¤ 3:</span> å¤„ç†è¿›åº¦
                        </h3>
                    </div>
                    
                    <div class="p-6" id="videoList">
                        <!-- åŠ¨æ€æ·»åŠ çš„è§†é¢‘é¡¹ç›® -->
                    </div>
                </div>
            </div>

            <!-- å³ä¾§ï¼šå‚æ•°é…ç½®é¢æ¿ -->
            <div class="lg:col-span-1">
                <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
                    <h2 class="text-xl font-bold text-white mb-6">
                        <span class="text-green-400">æ­¥éª¤ 4:</span> å¤„ç†è®¾ç½®
                    </h2>
                    
                    <!-- åŠ¨æ€é…ç½®é¢æ¿ -->
                    <div id="configPanel">
                        <!-- å»é™¤å­—å¹•é…ç½® -->
                        <div id="removeSubtitleConfig" class="config-section">
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-3">å¤„ç†è´¨é‡</label>
                                    <div class="grid grid-cols-1 gap-2">
                                        <button class="bg-blue-600 text-white text-sm py-3 px-4 rounded-lg text-left">
                                            <div class="font-semibold">é«˜æ¸… 1080p</div>
                                            <div class="text-xs text-blue-200">æ¨èè®¾ç½® - Â¥2/åˆ†é’Ÿ</div>
                                        </button>
                                        <button class="bg-slate-700 text-gray-300 text-sm py-3 px-4 rounded-lg hover:bg-slate-600 text-left">
                                            <div class="font-semibold">æ ‡æ¸… 720p</div>
                                            <div class="text-xs text-gray-400">ç»æµé€‰æ‹© - Â¥1/åˆ†é’Ÿ</div>
                                        </button>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-3">è¯†åˆ«æ¨¡å¼</label>
                                    <div class="grid grid-cols-1 gap-2">
                                        <button class="bg-green-600 text-white text-sm py-3 px-4 rounded-lg text-left" id="autoMode">
                                            <div class="font-semibold">ğŸ¤– AIè‡ªåŠ¨è¯†åˆ«</div>
                                            <div class="text-xs text-green-200">æ™ºèƒ½æ£€æµ‹å„ç§å­—å¹•æ ·å¼</div>
                                        </button>
                                        <button class="bg-slate-700 text-gray-300 text-sm py-3 px-4 rounded-lg hover:bg-slate-600 text-left">
                                            <div class="font-semibold">âœ‹ æ‰‹åŠ¨é€‰æ‹©åŒºåŸŸ</div>
                                            <div class="text-xs text-gray-400">ç²¾ç¡®æŒ‡å®šå­—å¹•åŒºåŸŸ</div>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- å…¶ä»–åŠŸèƒ½é…ç½®å°†åŠ¨æ€æ˜¾ç¤º -->
                        <div id="otherConfigs" style="display: none;">
                            <!-- æ ¹æ®é€‰æ‹©çš„èƒ½åŠ›åŠ¨æ€åŠ è½½é…ç½®é€‰é¡¹ -->
                        </div>
                    </div>

                    <!-- æˆæœ¬é¢„ä¼° -->
                    <div class="bg-blue-600/20 border border-blue-500/30 rounded-lg p-4 mt-6">
                        <h4 class="font-semibold text-white mb-2">ğŸ’° è´¹ç”¨é¢„ä¼°</h4>
                        <div class="text-sm text-gray-300 space-y-1">
                            <div class="flex justify-between">
                                <span>é¢„è®¡æ—¶é•¿:</span>
                                <span id="estimatedDuration">--</span>
                            </div>
                            <div class="flex justify-between">
                                <span>å¤„ç†è´¹ç”¨:</span>
                                <span id="estimatedCost">--</span>
                            </div>
                            <div class="border-t border-blue-500/30 pt-2 mt-2">
                                <div class="flex justify-between font-semibold text-blue-400">
                                    <span>æ€»è®¡:</span>
                                    <span id="totalCost">1åˆ†é’Ÿå…è´¹è¯•ç”¨</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- æ“ä½œæŒ‰é’® -->
                    <div class="space-y-3 mt-6">
                        <button id="startProcessBtn" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white py-3 rounded-lg font-semibold" disabled>
                            <i class="fas fa-play mr-2"></i>å¼€å§‹å¤„ç†
                        </button>
                        <button class="w-full bg-slate-700 hover:bg-slate-600 text-white py-2 rounded-lg">
                            <i class="fas fa-question-circle mr-2"></i>ä½¿ç”¨å¸®åŠ©
                        </button>
                    </div>
                </div>

                <!-- åŠŸèƒ½ä»‹ç» -->
                <div class="bg-yellow-600/20 border border-yellow-500/30 rounded-xl p-4 mt-6">
                    <h4 class="font-semibold text-white mb-2">
                        <i class="fas fa-lightbulb text-yellow-400 mr-2"></i>åŠŸèƒ½è¯´æ˜
                    </h4>
                    <div id="capabilityDescription" class="text-sm text-gray-300">
                        <p><strong>æ™ºèƒ½æ“¦é™¤ï¼š</strong>ä½¿ç”¨AIæŠ€æœ¯è‡ªåŠ¨è¯†åˆ«å’Œå»é™¤è§†é¢‘ä¸­çš„å­—å¹•ã€æ°´å°ã€Logoç­‰å…ƒç´ ï¼Œä¿æŒè§†é¢‘å†…å®¹çš„å®Œæ•´æ€§ã€‚</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- çº¯å‰ç«¯JavaScriptæ¨¡å— -->
    <script src="js/notification.js"></script>
    <script src="js/video-processor.js"></script>
    
    <script>
        let uploadedFile = null;
        let isProcessing = false;
        let selectedCapability = 'eraser';

        // ä½¿ç”¨å…¨å±€è§†é¢‘å¤„ç†å™¨
        const processor = window.videoProcessor;

        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        document.addEventListener('DOMContentLoaded', function() {
            // ç­‰å¾…å¤„ç†å™¨åŠ è½½å®Œæˆ
            setTimeout(() => {
                setupEventListeners();
                initializeUI();
            }, 100);
        });

        function setupEventListeners() {
            // èƒ½åŠ›é€‰æ‹©å¤„ç†
            document.querySelectorAll('.capability-card').forEach(card => {
                card.addEventListener('click', function() {
                    const capability = this.dataset.capability;
                    selectCapability(capability);
                });
            });

            // ç›‘å¬å¤„ç†å™¨äº‹ä»¶
            document.addEventListener('capabilityChanged', (event) => {
                updateUIFromProcessor(event.detail);
            });

            document.addEventListener('fileInfoUpdated', (event) => {
                showFileInfo(event.detail);
            });

            document.addEventListener('costUpdated', (event) => {
                updateCostDisplay(event.detail);
            });

            document.addEventListener('processingProgress', (event) => {
                updateProgressDisplay(event.detail);
            });

            document.addEventListener('fileRemoved', () => {
                clearFileDisplay();
            });
        }

        function selectCapability(capability) {
            // æ›´æ–°é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.capability-card').forEach(card => {
                card.classList.remove('active', 'bg-blue-600/20', 'border-blue-500/50');
                card.classList.add('bg-slate-700', 'hover:bg-slate-600');
            });

            const selectedCard = document.querySelector(`[data-capability="${capability}"]`);
            if (selectedCard) {
                selectedCard.classList.remove('bg-slate-700', 'hover:bg-slate-600');
                selectedCard.classList.add('active', 'bg-blue-600/20', 'border-blue-500/50');
            }

            // ä½¿ç”¨å¤„ç†å™¨é€‰æ‹©èƒ½åŠ›
            processor.selectCapability(capability);
            selectedCapability = capability;
        }

        function updateUIFromProcessor(detail) {
            const { capability, capabilityId } = detail;
            
            // æ›´æ–°å½“å‰é€‰æ‹©æ˜¾ç¤º
            document.getElementById('selectedCapability').textContent = 
                `${capability.name} - ${capability.description.substring(0, 30)}...`;
            document.getElementById('selectedPrice').textContent = 
                `èµ·ä»·: ${capability.price}`;

            // æ›´æ–°åŠŸèƒ½è¯´æ˜
            document.getElementById('capabilityDescription').innerHTML = 
                `<p><strong>${capability.name}ï¼š</strong>${capability.description}</p>`;

            // æ›´æ–°é…ç½®é¢æ¿
            updateConfigPanel(capabilityId);
            
            // æ›´æ–°æ–‡ä»¶æ ¼å¼æç¤º
            updateFileFormatHint(capabilityId);
        }

        function updateFileFormatHint(capabilityId) {
            const hint = document.getElementById('fileFormatHint');
            if (!hint) return;
            
            if (capabilityId === 'voiceClone') {
                hint.textContent = 'æ”¯æŒæ ¼å¼ï¼šwav, mp3, aac, m4a, wma, asf | æœ€å¤§æ–‡ä»¶ï¼š5MB | å»ºè®®ï¼š15-20ç§’éŸ³é¢‘';
                hint.className = 'text-sm text-yellow-400';
            } else {
                hint.textContent = 'æ”¯æŒæ ¼å¼ï¼šMP4, AVI, MOV, MKV | æœ€å¤§æ–‡ä»¶ï¼š500MB';
                hint.className = 'text-sm text-gray-500';
            }
        }

        function updateConfigPanel(capability) {
            // éšè—æ‰€æœ‰é…ç½®
            const removeSubtitleConfig = document.getElementById('removeSubtitleConfig');
            const otherConfigs = document.getElementById('otherConfigs');
            
            if (removeSubtitleConfig) removeSubtitleConfig.style.display = 'none';
            if (otherConfigs) otherConfigs.style.display = 'none';

            if (capability === 'removeSubtitle') {
                if (removeSubtitleConfig) removeSubtitleConfig.style.display = 'block';
            } else {
                // ä¸ºå…¶ä»–åŠŸèƒ½æ˜¾ç¤ºé€šç”¨é…ç½®
                if (otherConfigs) {
                    otherConfigs.style.display = 'block';
                    otherConfigs.innerHTML = processor.generateConfigHTML(capability);
                }
            }
        }

        function generateConfigForCapability(capability) {
            const config = capabilityConfigs[capability];
            let configHTML = '<div class="space-y-6">';

            switch(capability) {
                case 'trim':
                    configHTML += `
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-3">å‰ªè¾‘æ¨¡å¼</label>
                            <div class="grid grid-cols-1 gap-2">
                                <button class="bg-blue-600 text-white text-sm py-3 px-4 rounded-lg text-left">
                                    <div class="font-semibold">æ™ºèƒ½å‰ªè¾‘</div>
                                    <div class="text-xs text-blue-200">AIè¯†åˆ«ç²¾å½©ç‰‡æ®µ</div>
                                </button>
                                <button class="bg-slate-700 text-gray-300 text-sm py-3 px-4 rounded-lg hover:bg-slate-600 text-left">
                                    <div class="font-semibold">æ—¶é—´ç‚¹å‰ªè¾‘</div>
                                    <div class="text-xs text-gray-400">æ‰‹åŠ¨è®¾å®šæ—¶é—´èŒƒå›´</div>
                                </button>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">æ—¶é—´èŒƒå›´ï¼ˆç§’ï¼‰</label>
                            <div class="grid grid-cols-2 gap-2">
                                <input type="number" placeholder="å¼€å§‹" class="bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white text-sm">
                                <input type="number" placeholder="ç»“æŸ" class="bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white text-sm">
                            </div>
                        </div>
                    `;
                    break;
                case 'compress':
                    configHTML += `
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-3">è¾“å‡ºæ ¼å¼</label>
                            <select class="w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white text-sm">
                                <option>MP4 (æ¨è)</option>
                                <option>AVI</option>
                                <option>MOV</option>
                                <option>MKV</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-3">å‹ç¼©ç¨‹åº¦</label>
                            <div class="grid grid-cols-1 gap-2">
                                <button class="bg-blue-600 text-white text-sm py-2 px-3 rounded-lg">é«˜è´¨é‡</button>
                                <button class="bg-slate-700 text-gray-300 text-sm py-2 px-3 rounded-lg hover:bg-slate-600">å¹³è¡¡</button>
                                <button class="bg-slate-700 text-gray-300 text-sm py-2 px-3 rounded-lg hover:bg-slate-600">é«˜å‹ç¼©</button>
                            </div>
                        </div>
                    `;
                    break;
                case 'filter':
                    configHTML += `
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-3">æ»¤é•œç±»å‹</label>
                            <div class="grid grid-cols-2 gap-2">
                                <button class="bg-blue-600 text-white text-xs py-2 px-2 rounded">å¤å¤</button>
                                <button class="bg-slate-700 text-gray-300 text-xs py-2 px-2 rounded hover:bg-slate-600">æ¸…æ–°</button>
                                <button class="bg-slate-700 text-gray-300 text-xs py-2 px-2 rounded hover:bg-slate-600">æš–è°ƒ</button>
                                <button class="bg-slate-700 text-gray-300 text-xs py-2 px-2 rounded hover:bg-slate-600">å†·è°ƒ</button>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">å¼ºåº¦è°ƒèŠ‚</label>
                            <input type="range" class="w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer" min="0" max="100" value="50">
                        </div>
                    `;
                    break;
                default:
                    configHTML += `
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-3">å¤„ç†æ¨¡å¼</label>
                            <div class="grid grid-cols-1 gap-2">
                                <button class="bg-blue-600 text-white text-sm py-3 px-4 rounded-lg text-left">
                                    <div class="font-semibold">æ ‡å‡†æ¨¡å¼</div>
                                    <div class="text-xs text-blue-200">å¹³è¡¡è´¨é‡å’Œé€Ÿåº¦</div>
                                </button>
                                <button class="bg-slate-700 text-gray-300 text-sm py-3 px-4 rounded-lg hover:bg-slate-600 text-left">
                                    <div class="font-semibold">é«˜è´¨é‡æ¨¡å¼</div>
                                    <div class="text-xs text-gray-400">æ›´å¥½æ•ˆæœï¼Œè€—æ—¶è¾ƒé•¿</div>
                                </button>
                            </div>
                        </div>
                    `;
            }

            configHTML += '</div>';
            return configHTML;
        }

        // æ–‡ä»¶æ‹–æ‹½å¤„ç†
        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        }

        // æ–‡ä»¶é€‰æ‹©å¤„ç†
        function handleFileSelect(e) {
            const file = e.target.files[0];
            if (file) {
                handleFile(file);
            }
        }

        // å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶
        function handleFile(file) {
            if (processor.handleFileUpload(file)) {
                uploadedFile = file;
                // å¯ç”¨å¤„ç†æŒ‰é’®
                const btn = document.getElementById('startProcessBtn');
                if (btn) btn.disabled = false;
            }
        }

        // æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
        function showFileInfo(fileInfo) {
            const processingList = document.getElementById('processingList');
            const videoList = document.getElementById('videoList');
            
            if (processingList) processingList.style.display = 'block';
            
            const videoItem = `
                <div class="flex items-center space-x-4 p-4 bg-slate-700/50 rounded-lg" id="videoItem">
                    <div class="w-16 h-12 bg-gradient-to-br from-slate-600 to-slate-700 rounded-lg flex items-center justify-center">
                        <i class="fas fa-video text-white text-sm"></i>
                    </div>
                    <div class="flex-1">
                        <h4 class="font-semibold text-white">${fileInfo.name}</h4>
                        <div class="text-sm text-gray-400">å¤§å°: ${fileInfo.size}MB | å¤„ç†: ${fileInfo.capability}</div>
                        <div class="text-sm text-blue-400">ç­‰å¾…å¤„ç†...</div>
                    </div>
                    <div class="flex space-x-2">
                        <button class="text-gray-400 p-2 rounded" onclick="removeFile()">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `;
            
            if (videoList) videoList.innerHTML = videoItem;
        }

        // æ›´æ–°è´¹ç”¨æ˜¾ç¤º
        function updateCostDisplay(estimation) {
            const elements = {
                duration: document.getElementById('estimatedDuration'),
                cost: document.getElementById('estimatedCost'),
                total: document.getElementById('totalCost')
            };

            if (estimation.isPerUse) {
                // å£°éŸ³å…‹éš†æŒ‰æ¬¡æ”¶è´¹
                if (elements.duration) elements.duration.textContent = 'å•æ¬¡å¤„ç†';
                if (elements.cost) elements.cost.textContent = `Â¥${estimation.cost}`;
                if (elements.total) elements.total.textContent = `Â¥${estimation.cost}`;
            } else {
                // æŒ‰åˆ†é’Ÿæ”¶è´¹
                if (elements.duration) elements.duration.textContent = `çº¦ ${estimation.duration} åˆ†é’Ÿ`;
                if (elements.cost) elements.cost.textContent = `Â¥${estimation.cost.toFixed(1)}`;
                
                if (elements.total) {
                    if (estimation.freeTrialCost <= 0) {
                        elements.total.textContent = '1åˆ†é’Ÿå…è´¹è¯•ç”¨';
                    } else {
                        elements.total.textContent = `Â¥${estimation.freeTrialCost.toFixed(1)}`;
                    }
                }
            }
        }

        // æ›´æ–°è¿›åº¦æ˜¾ç¤º
        function updateProgressDisplay(detail) {
            const { progress, capabilityName, completed } = detail;
            const videoItem = document.getElementById('videoItem');
            
            if (!videoItem) return;

            const statusElement = videoItem.querySelector('.text-blue-400');
            if (!statusElement) return;

            if (completed) {
                statusElement.textContent = `${capabilityName}å®Œæˆï¼`;
                statusElement.className = 'text-sm text-green-400';
                
                // æ·»åŠ ä¸‹è½½æŒ‰é’®
                const progressContainer = videoItem.querySelector('.progress-container');
                if (progressContainer) {
                    progressContainer.innerHTML = `
                        <i class="fas fa-check mr-1"></i>${capabilityName}å®Œæˆ 
                        <button class="ml-4 bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-xs">
                            <i class="fas fa-download mr-1"></i>ä¸‹è½½
                        </button>
                    `;
                }
                
                // é‡ç½®å¤„ç†æŒ‰é’®
                const startBtn = document.getElementById('startProcessBtn');
                if (startBtn) {
                    startBtn.disabled = false;
                    startBtn.innerHTML = '<i class="fas fa-play mr-2"></i>å¼€å§‹å¤„ç†';
                }
                isProcessing = false;
            } else {
                // æ›´æ–°è¿›åº¦
                if (!videoItem.querySelector('.progress-container')) {
                    const progressElement = document.createElement('div');
                    progressElement.className = 'mt-2 progress-container';
                    progressElement.innerHTML = `
                        <div class="w-full bg-slate-600 rounded-full h-2">
                            <div class="progress-bar bg-gradient-to-r from-blue-500 to-green-500 h-2 rounded-full transition-all duration-300" style="width: ${progress}%"></div>
                        </div>
                        <div class="text-xs text-blue-400 mt-1">${capabilityName}ä¸­... ${progress}%</div>
                    `;
                    statusElement.parentElement.appendChild(progressElement);
                    statusElement.textContent = `æ­£åœ¨${capabilityName}...`;
                } else {
                    // æ›´æ–°ç°æœ‰è¿›åº¦
                    const progressBar = videoItem.querySelector('.progress-bar');
                    const progressText = videoItem.querySelector('.progress-container .text-xs');
                    
                    if (progressBar) progressBar.style.width = `${progress}%`;
                    if (progressText) progressText.textContent = `${capabilityName}ä¸­... ${progress}%`;
                }
            }
        }

        // æ¸…é™¤æ–‡ä»¶æ˜¾ç¤º
        function clearFileDisplay() {
            const processingList = document.getElementById('processingList');
            const startBtn = document.getElementById('startProcessBtn');
            const costElements = ['estimatedDuration', 'estimatedCost', 'totalCost'];
            
            if (processingList) processingList.style.display = 'none';
            if (startBtn) startBtn.disabled = true;
            
            costElements.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.textContent = id === 'totalCost' ? '1åˆ†é’Ÿå…è´¹è¯•ç”¨' : '--';
            });
            
            uploadedFile = null;
        }

        // æ›´æ–°æˆæœ¬é¢„ä¼°
        function updateCostEstimate(file) {
            // ä¼°ç®—è§†é¢‘æ—¶é•¿ï¼ˆè¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…éœ€è¦è¯»å–è§†é¢‘å…ƒæ•°æ®ï¼‰
            const estimatedMinutes = Math.max(1, Math.floor(file.size / (1024 * 1024) / 10)); // ç®€å•ä¼°ç®—
            const pricePerMinute = capabilityConfigs[selectedCapability].pricePerMinute;
            
            document.getElementById('estimatedDuration').textContent = `çº¦ ${estimatedMinutes} åˆ†é’Ÿ`;
            document.getElementById('estimatedCost').textContent = `Â¥${(estimatedMinutes * pricePerMinute).toFixed(1)}`;
            
            // å…è´¹è¯•ç”¨é€»è¾‘
            if (estimatedMinutes <= 10) {
                document.getElementById('totalCost').textContent = 'å…è´¹è¯•ç”¨';
            } else {
                const extraMinutes = estimatedMinutes - 10;
                document.getElementById('totalCost').textContent = `Â¥${(extraMinutes * pricePerMinute).toFixed(1)}`;
            }
        }

        // ç§»é™¤æ–‡ä»¶
        function removeFile() {
            processor.removeFile();
            const fileInput = document.getElementById('fileInput');
            if (fileInput) fileInput.value = '';
        }

        // åˆå§‹åŒ–UI
        function initializeUI() {
            // è®¾ç½®å¼€å§‹å¤„ç†æŒ‰é’®äº‹ä»¶
            const startBtn = document.getElementById('startProcessBtn');
            if (startBtn) {
                startBtn.addEventListener('click', async function() {
                    if (!uploadedFile || isProcessing) return;
                    
                    isProcessing = true;
                    this.disabled = true;
                    const capability = processor.getCapability(selectedCapability);
                    this.innerHTML = `<i class="fas fa-spinner fa-spin mr-2"></i>æ­£åœ¨${capability.name}...`;
                    
                    // å¼€å§‹å¤„ç†
                    await processor.startProcessing();
                });
            }

            // é»˜è®¤é€‰æ‹©å»é™¤å­—å¹•
            selectCapability('removeSubtitle');
        }

        // å¤„ç†æ¥è‡ªçˆ¶é¡µé¢çš„å¯¼èˆªå‚æ•°
        window.handleNavigation = function(params) {
            if (params.activeFunction) {
                // å¦‚æœæŒ‡å®šäº†åŠŸèƒ½ï¼Œåˆ‡æ¢åˆ°å¯¹åº”çš„èƒ½åŠ›
                const capability = params.activeFunction;
                if (processor && processor.capabilities[capability]) {
                    selectCapability(capability);
                }
            }
        };
    </script>
    
    <!-- ç»Ÿä¸€å¯¼èˆªæ ç»„ä»¶ -->
    <script src="components/navbar.js"></script>
    <script>
        // åˆå§‹åŒ–å¯¼èˆªæ 
        document.addEventListener('DOMContentLoaded', function() {
            window.unifiedNavbar = new UnifiedNavbar('workspace');
            window.unifiedNavbar.render();
        });
    </script>
</body>
</html> 